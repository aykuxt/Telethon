
<!DOCTYPE html>

<html class="no-js" lang="en">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width,initial-scale=1" name="viewport"/>
<link href="https://aykuxt.github.io/Telethon/concepts/asyncio/" rel="canonical"/>
<link href="../../assets/images/favicon.png" rel="shortcut icon"/>
<meta content="mkdocs-1.1.2, mkdocs-material-5.2.2" name="generator"/>
<title>Mastering asyncio - Telethon Docs</title>
<link href="../../assets/stylesheets/main.a2408e81.min.css" rel="stylesheet"/>
<link href="../../assets/stylesheets/palette.a46bcfb3.min.css" rel="stylesheet"/>
<meta content="#3f51b5" name="theme-color"/>
<link crossorigin="" href="https://fonts.gstatic.com" rel="preconnect"/>
<link href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&amp;display=fallback" rel="stylesheet"/>
<style>body,input{font-family:"Roboto",-apple-system,BlinkMacSystemFont,Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono",SFMono-Regular,Consolas,Menlo,monospace}</style>
<link href="../../assets/css/custom.css" rel="stylesheet"/>
</head>
<body data-md-color-accent="amber" data-md-color-primary="indigo" data-md-color-scheme="default" dir="ltr">
<input autocomplete="off" class="md-toggle" data-md-toggle="drawer" id="__drawer" type="checkbox"/>
<input autocomplete="off" class="md-toggle" data-md-toggle="search" id="__search" type="checkbox"/>
<label class="md-overlay" for="__drawer"></label>
<div data-md-component="skip">
<a class="md-skip" href="#mastering-asyncio">
          Skip to content
        </a>
</div>
<div data-md-component="announce">
</div>
<header class="md-header" data-md-component="header">
<nav aria-label="Header" class="md-header-nav md-grid">
<a aria-label="Telethon Docs" class="md-header-nav__button md-logo" href="https://aykuxt.github.io/Telethon/" title="Telethon Docs">
<img alt="logo" src="../../assets/images/nav-logo.svg"/>
</a>
<label class="md-header-nav__button md-icon" for="__drawer">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"></path></svg>
</label>
<div class="md-header-nav__title" data-md-component="header-title">
<div class="md-header-nav__ellipsis">
<span class="md-header-nav__topic md-ellipsis">
            Telethon Docs
          </span>
<span class="md-header-nav__topic md-ellipsis">
            
              Mastering asyncio
            
          </span>
</div>
</div>
<label class="md-header-nav__button md-icon" for="__search">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"></path></svg>
</label>
<div class="md-search" data-md-component="search" role="dialog">
<label class="md-search__overlay" for="__search"></label>
<div class="md-search__inner" role="search">
<form class="md-search__form" name="search">
<input aria-label="Search" autocapitalize="off" autocomplete="off" autocorrect="off" class="md-search__input" data-md-component="search-query" data-md-state="active" name="query" placeholder="Search" spellcheck="false" type="text"/>
<label class="md-search__icon md-icon" for="__search">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"></path></svg>
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"></path></svg>
</label>
<button aria-label="Clear" class="md-search__icon md-icon" data-md-component="search-reset" tabindex="-1" type="reset">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"></path></svg>
</button>
</form>
<div class="md-search__output">
<div class="md-search__scrollwrap" data-md-scrollfix="">
<div class="md-search-result" data-md-component="search-result">
<div class="md-search-result__meta">
            Initializing search
          </div>
<ol class="md-search-result__list"></ol>
</div>
</div>
</div>
</div>
</div>
<div class="md-header-nav__source">
<a class="md-source" href="https://github.com/LonamiWebs/Telethon/" title="Go to repository">
<div class="md-source__icon md-icon">
<svg viewbox="0 0 448 512" xmlns="http://www.w3.org/2000/svg"><path d="M439.55 236.05L244 40.45a28.87 28.87 0 00-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 01-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 000 40.81l195.61 195.6a28.86 28.86 0 0040.8 0l194.69-194.69a28.86 28.86 0 000-40.81z"></path></svg>
</div>
<div class="md-source__repository">
    LonamiWebs/Telethon
  </div>
</a>
</div>
</nav>
</header>
<div class="md-container" data-md-component="container">
<nav aria-label="Tabs" class="md-tabs md-tabs--active" data-md-component="tabs">
<div class="md-tabs__inner md-grid">
<ul class="md-tabs__list">
<li class="md-tabs__item">
<a class="md-tabs__link" href="../..">
          First Steps
        </a>
</li>
<li class="md-tabs__item">
<a class="md-tabs__link" href="../../quick-references/faq/">
          Quick References
        </a>
</li>
<li class="md-tabs__item">
<a class="md-tabs__link md-tabs__link--active" href="../strings/">
          Concepts
        </a>
</li>
<li class="md-tabs__item">
<a class="md-tabs__link" href="../../developing/philosophy/">
          Developing
        </a>
</li>
<li class="md-tabs__item">
<a class="md-tabs__link" href="../../examples/word-of-warning/">
          Full API Examples
        </a>
</li>
<li class="md-tabs__item">
<a class="md-tabs__link" href="../../misc/changelog/">
          Miscellaneous
        </a>
</li>
<li class="md-tabs__item">
<a class="md-tabs__link" href="../../modules/helpers/">
          Modules
        </a>
</li>
</ul>
</div>
</nav>
<main class="md-main" data-md-component="main">
<div class="md-main__inner md-grid">
<div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
<div class="md-sidebar__scrollwrap">
<div class="md-sidebar__inner">
<nav aria-label="Navigation" class="md-nav md-nav--primary" data-md-level="0">
<label class="md-nav__title" for="__drawer">
<a aria-label="Telethon Docs" class="md-nav__button md-logo" href="https://aykuxt.github.io/Telethon/" title="Telethon Docs">
<img alt="logo" src="../../assets/images/nav-logo.svg"/>
</a>
    Telethon Docs
  </label>
<div class="md-nav__source">
<a class="md-source" href="https://github.com/LonamiWebs/Telethon/" title="Go to repository">
<div class="md-source__icon md-icon">
<svg viewbox="0 0 448 512" xmlns="http://www.w3.org/2000/svg"><path d="M439.55 236.05L244 40.45a28.87 28.87 0 00-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 01-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 000 40.81l195.61 195.6a28.86 28.86 0 0040.8 0l194.69-194.69a28.86 28.86 0 000-40.81z"></path></svg>
</div>
<div class="md-source__repository">
    LonamiWebs/Telethon
  </div>
</a>
</div>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" data-md-toggle="nav-1" id="nav-1" type="checkbox"/>
<label class="md-nav__link" for="nav-1">
      First Steps
      <span class="md-nav__icon md-icon">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M8.59 16.58L13.17 12 8.59 7.41 10 6l6 6-6 6-1.41-1.42z"></path></svg>
</span>
</label>
<nav aria-label="First Steps" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="nav-1">
<span class="md-nav__icon md-icon">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"></path></svg>
</span>
        First Steps
      </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../.." title="Getting Started">
      Getting Started
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../basic/installation/" title="Installation">
      Installation
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../basic/signing-in/" title="Signing In">
      Signing In
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../basic/quick-start/" title="Quick-Start">
      Quick-Start
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../basic/updates/" title="Updates">
      Updates
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../basic/next-steps/" title="Next Steps">
      Next Steps
    </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" data-md-toggle="nav-2" id="nav-2" type="checkbox"/>
<label class="md-nav__link" for="nav-2">
      Quick References
      <span class="md-nav__icon md-icon">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M8.59 16.58L13.17 12 8.59 7.41 10 6l6 6-6 6-1.41-1.42z"></path></svg>
</span>
</label>
<nav aria-label="Quick References" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="nav-2">
<span class="md-nav__icon md-icon">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"></path></svg>
</span>
        Quick References
      </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../quick-references/faq/" title="FAQ">
      FAQ
    </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--active md-nav__item--nested">
<input checked="" class="md-nav__toggle md-toggle" data-md-toggle="nav-3" id="nav-3" type="checkbox"/>
<label class="md-nav__link" for="nav-3">
      Concepts
      <span class="md-nav__icon md-icon">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M8.59 16.58L13.17 12 8.59 7.41 10 6l6 6-6 6-1.41-1.42z"></path></svg>
</span>
</label>
<nav aria-label="Concepts" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="nav-3">
<span class="md-nav__icon md-icon">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"></path></svg>
</span>
        Concepts
      </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../strings/" title="String-based Debugging">
      String-based Debugging
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../entities/" title="Entities">
      Entities
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../updates/" title="Updates in Dept">
      Updates in Dept
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../sessions/" title="Session Files">
      Session Files
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../full-api/" title="The Full API">
      The Full API
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../errors/" title="RPC Errors">
      RPC Errors
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../botapi-vs-mtproto/" title="HTTP Bot API vs MTProto">
      HTTP Bot API vs MTProto
    </a>
</li>
<li class="md-nav__item md-nav__item--active">
<input class="md-nav__toggle md-toggle" data-md-toggle="toc" id="__toc" type="checkbox"/>
<label class="md-nav__link md-nav__link--active" for="__toc">
        Mastering asyncio
        <span class="md-nav__icon md-icon">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M3 9h14V7H3v2m0 4h14v-2H3v2m0 4h14v-2H3v2m16 0h2v-2h-2v2m0-10v2h2V7h-2m0 6h2v-2h-2v2z"></path></svg>
</span>
</label>
<a class="md-nav__link md-nav__link--active" href="./" title="Mastering asyncio">
      Mastering asyncio
    </a>
<nav aria-label="Table of contents" class="md-nav md-nav--secondary">
<label class="md-nav__title" for="__toc">
<span class="md-nav__icon md-icon">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"></path></svg>
</span>
      Table of contents
    </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="#whats-asyncio">
    What's asyncio?
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#why-asyncio">
    Why asyncio?
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#what-are-asyncio-basics">
    What are asyncio basics?
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#what-does-telethonsync-do">
    What does telethon.sync do?
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#what-are-async-await-and-coroutines">
    What are async, await and coroutines?
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#can-i-use-threads">
    Can I use threads?
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#clientrun_until_disconnected-blocks">
    client.run_until_disconnected() blocks!
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#what-else-can-asyncio-do">
    What else can asyncio do?
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#why-does-clientstart-work-outside-async">
    Why does client.start() work outside async?
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#where-can-i-read-more">
    Where can I read more?
  </a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" data-md-toggle="nav-4" id="nav-4" type="checkbox"/>
<label class="md-nav__link" for="nav-4">
      Developing
      <span class="md-nav__icon md-icon">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M8.59 16.58L13.17 12 8.59 7.41 10 6l6 6-6 6-1.41-1.42z"></path></svg>
</span>
</label>
<nav aria-label="Developing" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="nav-4">
<span class="md-nav__icon md-icon">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"></path></svg>
</span>
        Developing
      </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../developing/philosophy/" title="Philosophy">
      Philosophy
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../developing/test-servers/" title="Test Servers">
      Test Servers
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../developing/project-structure/" title="Project Structure">
      Project Structure
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../developing/coding-style/" title="Coding Style">
      Coding Style
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../developing/testing/" title="Tests">
      Tests
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../developing/understanding-the-type-language/" title="Understanding the Type Language">
      Understanding the Type Language
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../developing/tips-for-porting-the-project/" title="Tips for Porting the Project">
      Tips for Porting the Project
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../developing/telegram-api-in-other-languages/" title="Telegram API in Other Languages">
      Telegram API in Other Languages
    </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" data-md-toggle="nav-5" id="nav-5" type="checkbox"/>
<label class="md-nav__link" for="nav-5">
      Full API Examples
      <span class="md-nav__icon md-icon">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M8.59 16.58L13.17 12 8.59 7.41 10 6l6 6-6 6-1.41-1.42z"></path></svg>
</span>
</label>
<nav aria-label="Full API Examples" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="nav-5">
<span class="md-nav__icon md-icon">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"></path></svg>
</span>
        Full API Examples
      </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../examples/word-of-warning/" title="A Word of Warning">
      A Word of Warning
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../examples/chats-and-channels/" title="Working with Chats and Channels">
      Working with Chats and Channels
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../examples/users/" title="Users">
      Users
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../examples/working-with-messages/" title="Working with messages">
      Working with messages
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../examples/projects-using-telethon/" title="Projects using Telethon">
      Projects using Telethon
    </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" data-md-toggle="nav-6" id="nav-6" type="checkbox"/>
<label class="md-nav__link" for="nav-6">
      Miscellaneous
      <span class="md-nav__icon md-icon">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M8.59 16.58L13.17 12 8.59 7.41 10 6l6 6-6 6-1.41-1.42z"></path></svg>
</span>
</label>
<nav aria-label="Miscellaneous" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="nav-6">
<span class="md-nav__icon md-icon">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"></path></svg>
</span>
        Miscellaneous
      </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../misc/changelog/" title="Changelog (Version History)">
      Changelog (Version History)
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../misc/wall-of-shame/" title="Wall of Shame">
      Wall of Shame
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../misc/compatibility-and-convenience/" title="Compatibility and Convenience">
      Compatibility and Convenience
    </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" data-md-toggle="nav-7" id="nav-7" type="checkbox"/>
<label class="md-nav__link" for="nav-7">
      Modules
      <span class="md-nav__icon md-icon">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M8.59 16.58L13.17 12 8.59 7.41 10 6l6 6-6 6-1.41-1.42z"></path></svg>
</span>
</label>
<nav aria-label="Modules" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="nav-7">
<span class="md-nav__icon md-icon">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"></path></svg>
</span>
        Modules
      </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../modules/helpers/" title="Helpers">
      Helpers
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../modules/utils/" title="Utilities">
      Utilities
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../modules/custom/" title="Custom package">
      Custom package
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../modules/errors/" title="API Errors">
      API Errors
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../modules/client/" title="TelegramClient">
      TelegramClient
    </a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</div>
</div>
</div>
<div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
<div class="md-sidebar__scrollwrap">
<div class="md-sidebar__inner">
<nav aria-label="Table of contents" class="md-nav md-nav--secondary">
<label class="md-nav__title" for="__toc">
<span class="md-nav__icon md-icon">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"></path></svg>
</span>
      Table of contents
    </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="#whats-asyncio">
    What's asyncio?
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#why-asyncio">
    Why asyncio?
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#what-are-asyncio-basics">
    What are asyncio basics?
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#what-does-telethonsync-do">
    What does telethon.sync do?
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#what-are-async-await-and-coroutines">
    What are async, await and coroutines?
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#can-i-use-threads">
    Can I use threads?
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#clientrun_until_disconnected-blocks">
    client.run_until_disconnected() blocks!
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#what-else-can-asyncio-do">
    What else can asyncio do?
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#why-does-clientstart-work-outside-async">
    Why does client.start() work outside async?
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#where-can-i-read-more">
    Where can I read more?
  </a>
</li>
</ul>
</nav>
</div>
</div>
</div>
<div class="md-content">
<article class="md-content__inner md-typeset">
<a class="md-content__button md-icon" href="https://github.com/LonamiWebs/Telethon/edit/master/docs/concepts/asyncio.md" title="Edit this page">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25z"></path></svg>
</a>
<h1 id="mastering-asyncio">Mastering asyncio<a class="headerlink" href="#mastering-asyncio" title="Permanent link">¶</a></h1>
<h2 id="whats-asyncio">What's asyncio?<a class="headerlink" href="#whats-asyncio" title="Permanent link">¶</a></h2>
<p><code>asyncio</code> is a Python 3's built-in library. This means it's already installed if
you have Python 3. Since Python 3.5, it is convenient to work with asynchronous
code. Before (Python 3.4) we didn't have <code>async</code> or <code>await</code>, but now we do.</p>
<p><code>asyncio</code> stands for <em>Asynchronous Input Output</em>. This is a very powerful
concept to use whenever you work IO. Interacting with the web or external
APIs such as Telegram's makes a lot of sense this way.</p>
<h2 id="why-asyncio">Why asyncio?<a class="headerlink" href="#why-asyncio" title="Permanent link">¶</a></h2>
<p>Asynchronous IO makes a lot of sense in a library like Telethon.
You send a request to the server (such as "get some message"), and
thanks to <code>asyncio</code>, your code won't block while a response arrives.</p>
<p>The alternative would be to spawn a thread for each update so that
other code can run while the response arrives. That is <em>a lot</em> more
expensive.</p>
<p>The code will also run faster, because instead of switching back and
forth between the OS and your script, your script can handle it all.
Avoiding switching saves quite a bit of time, in Python or any other
language that supports asynchronous IO. It will also be cheaper,
because tasks are smaller than threads, which are smaller than processes.</p>
<h2 id="what-are-asyncio-basics">What are asyncio basics?<a class="headerlink" href="#what-are-asyncio-basics" title="Permanent link">¶</a></h2>
<div class="highlight"><pre><span></span><code><span class="c1"># First we need the asyncio library</span>
<span class="kn">import</span> <span class="nn">asyncio</span>

<span class="c1"># Then we need a loop to work with</span>
<span class="n">loop</span> <span class="o">=</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">get_event_loop</span><span class="p">()</span>

<span class="c1"># We also need something to run</span>
<span class="k">async</span> <span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
    <span class="k">for</span> <span class="n">char</span> <span class="ow">in</span> <span class="s1">'Hello, world!</span><span class="se">\n</span><span class="s1">'</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">char</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s1">''</span><span class="p">,</span> <span class="n">flush</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">await</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">0.2</span><span class="p">)</span>

<span class="c1"># Then, we need to run the loop with a task</span>
<span class="n">loop</span><span class="o">.</span><span class="n">run_until_complete</span><span class="p">(</span><span class="n">main</span><span class="p">())</span>
</code></pre></div>
<h2 id="what-does-telethonsync-do">What does telethon.sync do?<a class="headerlink" href="#what-does-telethonsync-do" title="Permanent link">¶</a></h2>
<p>The moment you import any of these:</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">telethon</span> <span class="kn">import</span> <span class="n">sync</span><span class="p">,</span> <span class="o">...</span>
<span class="c1"># or</span>
<span class="kn">from</span> <span class="nn">telethon.sync</span> <span class="kn">import</span> <span class="o">...</span>
<span class="c1"># or</span>
<span class="kn">import</span> <span class="nn">telethon.sync</span>
</code></pre></div>
<p>The <code>sync</code> module rewrites most <code>async def</code>
methods in Telethon to something similar to this:</p>
<div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">new_method</span><span class="p">():</span>
    <span class="n">result</span> <span class="o">=</span> <span class="n">original_method</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">loop</span><span class="o">.</span><span class="n">is_running</span><span class="p">():</span>
        <span class="c1"># the loop is already running, return the await-able to the user</span>
        <span class="k">return</span> <span class="n">result</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1"># the loop is not running yet, so we can run it for the user</span>
        <span class="k">return</span> <span class="n">loop</span><span class="o">.</span><span class="n">run_until_complete</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</code></pre></div>
<p>That means you can do this:</p>
<div class="highlight"><pre><span></span><code><span class="nb">print</span><span class="p">(</span><span class="n">client</span><span class="o">.</span><span class="n">get_me</span><span class="p">()</span><span class="o">.</span><span class="n">username</span><span class="p">)</span>
</code></pre></div>
<p>Instead of this:</p>
<div class="highlight"><pre><span></span><code><span class="n">me</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">loop</span><span class="o">.</span><span class="n">run_until_complete</span><span class="p">(</span><span class="n">client</span><span class="o">.</span><span class="n">get_me</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="n">me</span><span class="o">.</span><span class="n">username</span><span class="p">)</span>

<span class="c1"># or, using asyncio's default loop (it's the same)</span>
<span class="kn">import</span> <span class="nn">asyncio</span>
<span class="n">loop</span> <span class="o">=</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">get_event_loop</span><span class="p">()</span>  <span class="c1"># == client.loop</span>
<span class="n">me</span> <span class="o">=</span> <span class="n">loop</span><span class="o">.</span><span class="n">run_until_complete</span><span class="p">(</span><span class="n">client</span><span class="o">.</span><span class="n">get_me</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="n">me</span><span class="o">.</span><span class="n">username</span><span class="p">)</span>
</code></pre></div>
<p>As you can see, it's a lot of boilerplate and noise having to type
<code>run_until_complete</code> all the time, so you can let the magic module
to rewrite it for you. But notice the comment above: it won't run
the loop if it's already running, because it can't. That means this:</p>
<div class="highlight"><pre><span></span><code><span class="k">async</span> <span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
    <span class="c1"># 3. the loop is running here</span>
    <span class="nb">print</span><span class="p">(</span>
        <span class="n">client</span><span class="o">.</span><span class="n">get_me</span><span class="p">()</span>  <span class="c1"># 4. this will return a coroutine!</span>
        <span class="o">.</span><span class="n">username</span>  <span class="c1"># 5. this fails, coroutines don't have usernames</span>
    <span class="p">)</span>

<span class="n">loop</span><span class="o">.</span><span class="n">run_until_complete</span><span class="p">(</span>  <span class="c1"># 2. run the loop and the ``main()`` coroutine</span>
    <span class="n">main</span><span class="p">()</span>  <span class="c1"># 1. calling ``async def`` "returns" a coroutine</span>
<span class="p">)</span>
</code></pre></div>
<p>Will fail. So if you're inside an <code>async def</code>, then the loop is
running, and if the loop is running, you must <code>await</code> things yourself:</p>
<div class="highlight"><pre><span></span><code><span class="k">async</span> <span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
    <span class="nb">print</span><span class="p">((</span><span class="k">await</span> <span class="n">client</span><span class="o">.</span><span class="n">get_me</span><span class="p">())</span><span class="o">.</span><span class="n">username</span><span class="p">)</span>

<span class="n">loop</span><span class="o">.</span><span class="n">run_until_complete</span><span class="p">(</span><span class="n">main</span><span class="p">())</span>
</code></pre></div>
<h2 id="what-are-async-await-and-coroutines">What are async, await and coroutines?<a class="headerlink" href="#what-are-async-await-and-coroutines" title="Permanent link">¶</a></h2>
<p>The <code>async</code> keyword lets you define asynchronous functions,
also known as coroutines, and also iterate over asynchronous
loops or use <code>async with</code>:</p>
<div class="highlight"><pre><span></span><code><span class="kn">import</span> <span class="nn">asyncio</span>

<span class="k">async</span> <span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
    <span class="c1"># ^ this declares the main() coroutine function</span>

    <span class="k">async</span> <span class="k">with</span> <span class="n">client</span><span class="p">:</span>
        <span class="c1"># ^ this is an asynchronous with block</span>

        <span class="k">async</span> <span class="k">for</span> <span class="n">message</span> <span class="ow">in</span> <span class="n">client</span><span class="o">.</span><span class="n">iter_messages</span><span class="p">(</span><span class="n">chat</span><span class="p">):</span>
            <span class="c1"># ^ this is a for loop over an asynchronous generator</span>

            <span class="nb">print</span><span class="p">(</span><span class="n">message</span><span class="o">.</span><span class="n">sender</span><span class="o">.</span><span class="n">username</span><span class="p">)</span>

<span class="n">loop</span> <span class="o">=</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">get_event_loop</span><span class="p">()</span>
<span class="c1"># ^ this assigns the default event loop from the main thread to a variable</span>

<span class="n">loop</span><span class="o">.</span><span class="n">run_until_complete</span><span class="p">(</span><span class="n">main</span><span class="p">())</span>
<span class="c1"># ^ this runs the *entire* loop until the main() function finishes.</span>
<span class="c1">#   While the main() function does not finish, the loop will be running.</span>
<span class="c1">#   While the loop is running, you can't run it again.</span>
</code></pre></div>
<p>The <code>await</code> keyword blocks the <em>current</em> task, and the loop can run
other tasks. Tasks can be thought of as "threads", since many can run
concurrently:</p>
<div class="highlight"><pre><span></span><code><span class="kn">import</span> <span class="nn">asyncio</span>

<span class="k">async</span> <span class="k">def</span> <span class="nf">hello</span><span class="p">(</span><span class="n">delay</span><span class="p">):</span>
    <span class="k">await</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="n">delay</span><span class="p">)</span>  <span class="c1"># await tells the loop this task is "busy"</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">'hello'</span><span class="p">)</span>  <span class="c1"># eventually the loop resumes the code here</span>

<span class="k">async</span> <span class="k">def</span> <span class="nf">world</span><span class="p">(</span><span class="n">delay</span><span class="p">):</span>
    <span class="c1"># the loop decides this method should run first</span>
    <span class="k">await</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="n">delay</span><span class="p">)</span>  <span class="c1"># await tells the loop this task is "busy"</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">'world'</span><span class="p">)</span>  <span class="c1"># eventually the loop finishes all tasks</span>

<span class="n">loop</span> <span class="o">=</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">get_event_loop</span><span class="p">()</span>  <span class="c1"># get the default loop for the main thread</span>
<span class="n">loop</span><span class="o">.</span><span class="n">create_task</span><span class="p">(</span><span class="n">world</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>  <span class="c1"># create the world task, passing 2 as delay</span>
<span class="n">loop</span><span class="o">.</span><span class="n">create_task</span><span class="p">(</span><span class="n">hello</span><span class="p">(</span><span class="n">delay</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span>  <span class="c1"># another task, but with delay 1</span>
<span class="k">try</span><span class="p">:</span>
    <span class="c1"># run the event loop forever; ctrl+c to stop it</span>
    <span class="c1"># we could also run the loop for three seconds:</span>
    <span class="c1">#     loop.run_until_complete(asyncio.sleep(3))</span>
    <span class="n">loop</span><span class="o">.</span><span class="n">run_forever</span><span class="p">()</span>
<span class="k">except</span> <span class="ne">KeyboardInterrupt</span><span class="p">:</span>
    <span class="k">pass</span>
</code></pre></div>
<p>The same example, but without the comment noise:</p>
<div class="highlight"><pre><span></span><code><span class="kn">import</span> <span class="nn">asyncio</span>

<span class="k">async</span> <span class="k">def</span> <span class="nf">hello</span><span class="p">(</span><span class="n">delay</span><span class="p">):</span>
    <span class="k">await</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="n">delay</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">'hello'</span><span class="p">)</span>

<span class="k">async</span> <span class="k">def</span> <span class="nf">world</span><span class="p">(</span><span class="n">delay</span><span class="p">):</span>
    <span class="k">await</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="n">delay</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">'world'</span><span class="p">)</span>

<span class="n">loop</span> <span class="o">=</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">get_event_loop</span><span class="p">()</span>
<span class="n">loop</span><span class="o">.</span><span class="n">create_task</span><span class="p">(</span><span class="n">world</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
<span class="n">loop</span><span class="o">.</span><span class="n">create_task</span><span class="p">(</span><span class="n">hello</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
<span class="n">loop</span><span class="o">.</span><span class="n">run_until_complete</span><span class="p">(</span><span class="n">asyncio</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
</code></pre></div>
<h2 id="can-i-use-threads">Can I use threads?<a class="headerlink" href="#can-i-use-threads" title="Permanent link">¶</a></h2>
<p>Yes, you can, but you must understand that the loops themselves are
not thread safe. and you must be sure to know what is happening. You
may want to create a loop in a new thread and make sure to pass it to
the client:</p>
<div class="highlight"><pre><span></span><code><span class="kn">import</span> <span class="nn">asyncio</span>
<span class="kn">import</span> <span class="nn">threading</span>

<span class="k">def</span> <span class="nf">go</span><span class="p">():</span>
    <span class="n">loop</span> <span class="o">=</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">new_event_loop</span><span class="p">()</span>
    <span class="n">client</span> <span class="o">=</span> <span class="n">TelegramClient</span><span class="p">(</span><span class="o">...</span><span class="p">,</span> <span class="n">loop</span><span class="o">=</span><span class="n">loop</span><span class="p">)</span>
    <span class="o">...</span>

<span class="n">threading</span><span class="o">.</span><span class="n">Thread</span><span class="p">(</span><span class="n">target</span><span class="o">=</span><span class="n">go</span><span class="p">)</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
</code></pre></div>
<p>Generally, <strong>you don't need threads</strong> unless you know what you're doing.
Just create another task, as shown above. If you're using the Telethon
with a library that uses threads, you must be careful to use <code>threading.Lock</code>
whenever you use the client, or enable the compatible mode. For that, see
<a href="../../misc/compatibility-and-convenience/">Compatibility and Convenience</a>.</p>
<p>You may have seen this error:</p>
<div class="highlight"><pre><span></span><code>RuntimeError: There is no current event loop in thread 'Thread-1'.
</code></pre></div>
<p>It just means you didn't create a loop for that thread, and if you don't
pass a loop when creating the client, it uses <code>asyncio.get_event_loop()</code>,
which only works in the main thread.</p>
<h2 id="clientrun_until_disconnected-blocks"><code>client.run_until_disconnected()</code> blocks!<a class="headerlink" href="#clientrun_until_disconnected-blocks" title="Permanent link">¶</a></h2>
<p>All of what <code>client.run_until_disconnected()
&lt;telethon.client.updates.UpdateMethods.run_until_disconnected&gt;</code> does is
run the <code>asyncio</code>'s event loop until the client is disconnected. That means
<em>the loop is running</em>. And if the loop is running, it will run all the tasks
in it. So if you want to run <em>other</em> code, create tasks for it:</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">datetime</span> <span class="kn">import</span> <span class="n">datetime</span>

<span class="k">async</span> <span class="k">def</span> <span class="nf">clock</span><span class="p">():</span>
    <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">'The time:'</span><span class="p">,</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">())</span>
        <span class="k">await</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>

<span class="n">loop</span><span class="o">.</span><span class="n">create_task</span><span class="p">(</span><span class="n">clock</span><span class="p">())</span>
<span class="o">...</span>
<span class="n">client</span><span class="o">.</span><span class="n">run_until_disconnected</span><span class="p">()</span>
</code></pre></div>
<p>This creates a task for a clock that prints the time every second.
You don't need to use <code>client.run_until_disconnected()
&lt;telethon.client.updates.UpdateMethods.run_until_disconnected&gt;</code> either!
You just need to make the loop is running, somehow. <code>loop.run_forever()
&lt;asyncio.loop.run_forever()&gt;</code> and <code>loop.run_until_complete()
&lt;asyncio.loop.run_until_complete&gt;</code> can also be used to run
the loop, and Telethon will be happy with any approach.</p>
<p>Of course, there are better tools to run code hourly or daily, see below.</p>
<h2 id="what-else-can-asyncio-do">What else can asyncio do?<a class="headerlink" href="#what-else-can-asyncio-do" title="Permanent link">¶</a></h2>
<p>Asynchronous IO is a really powerful tool, as we've seen. There are plenty
of other useful libraries that also use <code>asyncio</code> and that you can integrate
with Telethon.</p>
<ul>
<li><a href="https://github.com/aio-libs/aiohttp">aiohttp</a> is like the infamous
  <a href="https://github.com/requests/requests/">requests</a> but asynchronous.</li>
<li><a href="https://gitlab.com/pgjones/quart">quart</a> is an asynchronous alternative
  to <a href="http://flask.pocoo.org/">Flask</a>.</li>
<li><a href="https://github.com/gawel/aiocron">aiocron</a> lets you schedule things
  to run things at a desired time, or run some tasks hourly, daily, etc.</li>
</ul>
<p>And of course, <a href="https://docs.python.org/3/library/asyncio.html">asyncio</a>
itself! It has a lot of methods that let you do nice things. For example,
you can run requests in parallel:</p>
<div class="highlight"><pre><span></span><code><span class="k">async</span> <span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
    <span class="n">last</span><span class="p">,</span> <span class="n">sent</span><span class="p">,</span> <span class="n">download_path</span> <span class="o">=</span> <span class="k">await</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">gather</span><span class="p">(</span>
        <span class="n">client</span><span class="o">.</span><span class="n">get_messages</span><span class="p">(</span><span class="s1">'TelethonChat'</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span>
        <span class="n">client</span><span class="o">.</span><span class="n">send_message</span><span class="p">(</span><span class="s1">'TelethonOfftopic'</span><span class="p">,</span> <span class="s1">'Hey guys!'</span><span class="p">),</span>
        <span class="n">client</span><span class="o">.</span><span class="n">download_profile_photo</span><span class="p">(</span><span class="s1">'TelethonChat'</span><span class="p">)</span>
    <span class="p">)</span>

<span class="n">loop</span><span class="o">.</span><span class="n">run_until_complete</span><span class="p">(</span><span class="n">main</span><span class="p">())</span>
</code></pre></div>
<p>This code will get the 10 last messages from <a href="https://t.me/TelethonChat">@TelethonChat</a>,
send one to <a href="https://t.me/TelethonOfftopic">@TelethonOfftopic</a>, and also
download the profile photo of the main group. <code>asyncio</code> will run all these
three tasks at the same time. You can run all the tasks you want this way.</p>
<p>A different way would be:</p>
<div class="highlight"><pre><span></span><code><span class="n">loop</span><span class="o">.</span><span class="n">create_task</span><span class="p">(</span><span class="n">client</span><span class="o">.</span><span class="n">get_messages</span><span class="p">(</span><span class="s1">'TelethonChat'</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
<span class="n">loop</span><span class="o">.</span><span class="n">create_task</span><span class="p">(</span><span class="n">client</span><span class="o">.</span><span class="n">send_message</span><span class="p">(</span><span class="s1">'TelethonOfftopic'</span><span class="p">,</span> <span class="s1">'Hey guys!'</span><span class="p">))</span>
<span class="n">loop</span><span class="o">.</span><span class="n">create_task</span><span class="p">(</span><span class="n">client</span><span class="o">.</span><span class="n">download_profile_photo</span><span class="p">(</span><span class="s1">'TelethonChat'</span><span class="p">))</span>
</code></pre></div>
<p>They will run in the background as long as the loop is running too.</p>
<p>You can also <a href="https://docs.python.org/3/library/asyncio-stream.html#asyncio.start_server">start an asyncio server</a>
in the main script, and from another script,
<a href="https://docs.python.org/3/library/asyncio-stream.html#asyncio.open_connection">connect to it</a>
to achieve <a href="https://en.wikipedia.org/wiki/Inter-process_communication&gt;">Inter-Process Communication</a>.
You can get as creative as you want. You can program anything you want.
When you use a library, you're not limited to use only its methods. You can
combine all the libraries you want. People seem to forget this simple fact!</p>
<h2 id="why-does-clientstart-work-outside-async">Why does <code>client.start()</code> work outside async?<a class="headerlink" href="#why-does-clientstart-work-outside-async" title="Permanent link">¶</a></h2>
<p>Because it's so common that it's really convenient to offer said
functionality by default. This means you can set up all your event
handlers and start the client without worrying about loops at all.</p>
<p>Using the client in a <code>with</code> block, <code>start
&lt;telethon.client.auth.AuthMethods.start&gt;</code>, <code>run_until_disconnected
&lt;telethon.client.updates.UpdateMethods.run_until_disconnected&gt;</code>, and
<code>disconnect &lt;telethon.client.telegrambaseclient.TelegramBaseClient.disconnect&gt;</code>
all support this.</p>
<h2 id="where-can-i-read-more">Where can I read more?<a class="headerlink" href="#where-can-i-read-more" title="Permanent link">¶</a></h2>
<p><a href="https://lonami.dev/blog/asyncio/">Check out my blog post</a> about <code>asyncio</code>,
which has some more examples and pictures to help you understand what happens
when the loop runs.</p>
</article>
</div>
</div>
</main>
<footer class="md-footer">
<div class="md-footer-nav">
<nav aria-label="Footer" class="md-footer-nav__inner md-grid">
<a class="md-footer-nav__link md-footer-nav__link--prev" href="../botapi-vs-mtproto/" rel="prev" title="HTTP Bot API vs MTProto">
<div class="md-footer-nav__button md-icon">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"></path></svg>
</div>
<div class="md-footer-nav__title">
<div class="md-ellipsis">
<span class="md-footer-nav__direction">
                  Previous
                </span>
                HTTP Bot API vs MTProto
              </div>
</div>
</a>
<a class="md-footer-nav__link md-footer-nav__link--next" href="../../developing/philosophy/" rel="next" title="Philosophy">
<div class="md-footer-nav__title">
<div class="md-ellipsis">
<span class="md-footer-nav__direction">
                  Next
                </span>
                Philosophy
              </div>
</div>
<div class="md-footer-nav__button md-icon">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"></path></svg>
</div>
</a>
</nav>
</div>
<div class="md-footer-meta md-typeset">
<div class="md-footer-meta__inner md-grid">
<div class="md-footer-copyright">
<div class="md-footer-copyright__highlight">
            Copyright © 2020 Telethon
          </div>
        
        Made with
        <a href="https://squidfunk.github.io/mkdocs-material/" rel="noopener" target="_blank">
          Material for MkDocs
        </a>
</div>
<div class="md-footer-social">
<a class="md-footer-social__link" href="https://github.com/LonamiWebs/Telethon" rel="noopener" target="_blank" title="github.com">
<svg viewbox="0 0 496 512" xmlns="http://www.w3.org/2000/svg"><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"></path></svg>
</a>
<a class="md-footer-social__link" href="https://t.me/TelethonChat" rel="noopener" target="_blank" title="t.me">
<svg viewbox="0 0 496 512" xmlns="http://www.w3.org/2000/svg"><path d="M248 8C111 8 0 119 0 256s111 248 248 248 248-111 248-248S385 8 248 8zm121.8 169.9l-40.7 191.8c-3 13.6-11.1 16.9-22.4 10.5l-62-45.7-29.9 28.8c-3.3 3.3-6.1 6.1-12.5 6.1l4.4-63.1 114.9-103.8c5-4.4-1.1-6.9-7.7-2.5l-142 89.4-61.2-19.1c-13.3-4.2-13.6-13.3 2.8-19.7l239.1-92.2c11.1-4 20.8 2.7 17.2 19.5z"></path></svg>
</a>
</div>
</div>
</div>
</footer>
</div>
<script src="../../assets/javascripts/vendor.d710d30a.min.js"></script>
<script src="../../assets/javascripts/bundle.5f27aba8.min.js"></script><script id="__lang" type="application/json">{"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents"}</script>
<script>
        app = initialize({
          base: "../..",
          features: ["instant", "tabs"],
          search: Object.assign({
            worker: "../../assets/javascripts/worker/search.27c6a5e6.min.js"
          }, typeof search !== "undefined" && search)
        })
      </script>
</body>
</html>